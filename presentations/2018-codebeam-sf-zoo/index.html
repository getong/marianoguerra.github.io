<!DOCTYPE html>
<html>
  <head>
    <title>A Tour Through the Distributed System Zoo</title>
    <meta charset="utf-8">
    <style>
      *{ font-family: 'Helvetica'; }
      .remark-slide-content{
          font-size: 2em;
          background-position: center;
          background-repeat: no-repeat;
          background-size: contain;
      }
	  code{font-size: 0.8em !important;}
      h1, h2, h3 {
        font-weight: normal;
      }
      .reverse-text h1{color: #fefefe; background-color: #111; padding: 0.2em;}
      .remark-code, .remark-inline-code { font-family: 'monospace'; font-size: 2em; background-color: white !important; }
      .remark-slide-content{padding: 0.5em 0 !important}
      .remark-slide-content p,.remark-slide-content ul {margin-left: 2em; margin-right: 2em;}
      .remark-container {background: none !important}
      .remark-slide-scaler{box-shador: none; -webkit-box-shadow: none;}
    </style>
  </head>
  <body>
    <textarea id="source" style="display: none">

class: center, middle

# A Tour Through the Distributed System Zoo

Mariano Guerra [@warianoguerra](https://twitter.com/warianoguerra)

[instadeq.com](https://instadeq.com) [@instadeq](https://twitter.com/instadeq)

Code BEAM

San Francisco 2018

---

class: center, middle

# Tried many ideas

---

class: center

![quadrant](imgs/quadrant.jpg)

---

background-image: url(imgs/evolution.jpg)

---

class: center

![venn](imgs/venn-diagram-beaver-duck-platypus.png)

---

class: center

![evolution](imgs/animal-exam.jpeg)

---

class: center

# Disclaimer

IANAZ

Bad Analogies Ahead

An attempt to map the territory

A RFC

---

class: center

# The story so far

<video src="imgs/dna-replication.mp4" loop autoplay><video>

Single organism operating on private data

[Source](https://www.youtube.com/watch?v=OjPcT1uUZiE)

---

class: center

![Lamport](imgs/Lamport265.jpg)

In 1978 Leslie Lamport tried to make two organisms agree on a value.

This has made a lot of people very angry and been widely regarded as a bad move.

---

# Consensus Species

Single Node: Critical Section

Cluster: Paxos, ZAB, Raft

Planetary Scale: DLT/Blockchain (PoW, PoS, PoET)
* Temporary "Race Conditions"
* Energy Usage

---

# Each Member

Data: All

Network View Cluster: Full

Network View DLT: Partial

---

# Tradeoff

Scalability for consistency

---

# Natural Predator

* Byzantine Attack
* Sybil Attack

---

# Core Idea

Shared serialized operation log

Agreeing on shared state

All members must apply ops in same order

Temporary leaders

---

# Algorithm tl;dr

* Propose a value
* Spread proposal
* Accept proposal
* Apply operation
* New state

---

# On Member Join

Data: Sync

---

# On Member Leave

Data: No Change

If it was leader: Leader Election

---

# Known Specimens

* Zookeeper (ZAB)
* Raft (Raft)
  + [Elixir Implementation](https://github.com/toniqsystems/raft)
* [riak_ensemble](https://github.com/basho/riak_ensemble) (Multi Paxos)

---

class: center

background-image: url(imgs/intermission.png)

# Nature Intermission

---

class: center

<video src="imgs/ant-bridge.mp4" loop autoplay></video>

[Source](https://www.quantamagazine.org/the-simple-algorithm-that-ants-use-to-build-bridges-20180226/)

---

class: center

<video src="imgs/ant-colony.mp4" loop autoplay></video>

[Source](https://www.youtube.com/watch?v=hXUCCRiNBOc)

---

# Commutative Species

Single Node: N/A

Cluster/Planetary Scale: Operational Transformations, CRDTs, Lasp

---

# Each Member

Data: All*

Network View: Partial or Full

---

# Tradeoff

Consistency for scalability

---

# Natural Predator

AWS bills

---

# Core Idea

Eventually but deterministically converging to the same shared view

Achieved by restricting operations to allow applying them in any order (commutativity)

Can gossip and scale more than consensus

Distant relatives that evolved under different constraints

DLT is a recent shared specimen since it accepts temporal divergence to scale

---

# Algorithm tl;dr

* Apply operation to data on any member
* Spread state/operation changes
* Apply on other members

---

# On Member Join

Data: Sync

---

# On Member Leave

Data: No Change

---

# Known Specimens

* [Lasp](http://lasp-lang.org/)
    + [Lasp CRDTs](https://github.com/lasp-lang/types/)
* [automerge](https://github.com/automerge/automerge)

---

class: center

background-image: url(imgs/intermission.png)

# Nature Intermission

---

class: center

<video src="imgs/fireflies.mp4" loop autoplay></video>

[Source](http://ncase.me/fireflies/)

---

# DHT Species

Single Node: Worker Pool

Cluster: Shard/Load Balance, Dynamo, Orleans

Planetary Scale: DHT, Chord

---

# Each Member

Data: Partial View

Network View Cluster: Full

Network View DHT: Partial

---

# Tradeoff

Consistency for scalability

---

# Natural Predator

![Justin Bieber](imgs/bieber.png)

[Source](https://twitter.com/dcurtis/status/23192425566)

---

# Core Idea

Consistent hashing

0/Log N hop routing table

Different members handle different parts of the problem space

---

# Algorithm tl;dr

* Land in a member
* Ask for directions
* Find the right member
* Deliver message

---

# On Member Join

Data: Migration of a "slice"

---

# On Member Leave

Data: Subset may be lost

Solved with replication (A new set of problems)

---

# Known Specimens

* [Riak](https://github.com/basho/riak) KV on top of dynamo [riak_core](https://hex.pm/packages/riak_core_ng)
* [Orleans](https://dotnet.github.io/orleans/)
    + [erleans](https://github.com/SpaceTime-IoT/erleans)
* Bitcoin
    + [Arweave](https://github.com/ArweaveTeam/arweave)
    + [aeternity/elixir-node](https://github.com/aeternity/elixir-node)

---

class: center

background-image: url(imgs/intermission.png)

# Nature Intermission

---

class: center

<video src="imgs/mold-tokyo-railway.mp4" loop autoplay></video>

[Source](https://youtu.be/GwKuFREOgmo)

---

background-image: url(imgs/flock-bird-800.jpg)

---

class: center

<video src="imgs/starlings.mp4" loop autoplay></video>

[Source](https://www.youtube.com/watch?v=L7CyMaOAqyo)

---

class: center, middle

# Thanks

Mariano Guerra [@warianoguerra](https://twitter.com/warianoguerra)

[instadeq.com](https://instadeq.com) [@instadeq](https://twitter.com/instadeq)


    </textarea>
    <script src="remark-latest.min.js">
    </script>
    <script>
      var slideshow = remark.create({ratio: '4:3'});
    </script>
  </body>
</html>
